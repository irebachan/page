<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <title>TRPGé¢¨ å¯¾æŠ—åˆ¤å®š å†’é™ºè¨˜</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 1em;
            background: #f0f0f0;
        }

        pre {
            background: #fff;
            padding: 1em;
            border: 1px solid #ccc;
            height: 500px;
            overflow-y: scroll;
            white-space: pre-wrap;
        }

        button {
            margin-top: 1em;
            padding: 0.5em 1em;
        }

        .success {
            color: green;
            font-weight: bold;
        }

        .fail {
            color: red;
            font-weight: bold;
        }

        .growth {
            color: blue;
            font-weight: bold;
        }

        .danger {
            color: crimson;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <h1>æ³¢ä¹±ä¸‡ä¸ˆï¼å¯¾æŠ—åˆ¤å®šå†’é™ºè¨˜</h1>
    <button onclick="startGame()">ã‚²ãƒ¼ãƒ é–‹å§‹</button>
    <pre id="log"></pre>

    <script>
        const ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ = ["å¿ƒ", "æŠ€", "ä½“"];
        const ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚­ã‚¹ãƒˆ = {
            å¿ƒ: ["å¿˜ã‚Œã¦ã„ãŸè¨˜æ†¶ãŒè˜‡ã‚‹â€¦â€¦ã€‚", "ä»²é–“ã¨ã®ã™ã‚Œé•ã„ã«å¿ƒãŒæºã‚Œã‚‹ã€‚", "ææ€–ã«æ‰“ã¡å‹ã¦ã‚‹ã‹ï¼Ÿ"],
            æŠ€: ["å¤ä»£ã®è£…ç½®ã‚’æ“ä½œã™ã‚‹ï¼", "ç²¾å¯†ãªç½ ã‚’è§£é™¤ã—ã‚ï¼", "éµã‚’é™ã‹ã«ãƒ”ãƒƒã‚­ãƒ³ã‚°ã™ã‚‹ã€‚"],
            ä½“: ["å·¨å¤§ãªå²©ã‚’æŠ¼ã—è¿”ã›ï¼", "å´©ã‚Œã‚‹æ©‹ã‚’å…¨åŠ›ã§æ¸¡ã‚Œï¼", "æ•µã®çŒ›æ”»ã‚’å—ã‘æ­¢ã‚ã‚ï¼"]
        };

        function å‡ºåŠ›(text, css = "") {
            const log = document.getElementById("log");
            const span = document.createElement("span");
            span.innerHTML = text + "<br>";
            if (css) span.className = css;
            log.appendChild(span);
            log.scrollTop = log.scrollHeight;
        }

        function ãƒ©ãƒ³ãƒ€ãƒ (array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function åˆ¤å®š(ã‚­ãƒ£ãƒ©, ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å, é›£æ˜“åº¦å€¤) {
            const å‡ºç›® = Math.floor(Math.random() * 10) + 1;
            const è‡ªåˆ†å€¤ = ã‚­ãƒ£ãƒ©[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å];
            const åˆ¤å®šå€¤ = Math.max(1, Math.min(9, 5 + (è‡ªåˆ†å€¤ - é›£æ˜“åº¦å€¤)));
            const æˆåŠŸ = å‡ºç›® <= åˆ¤å®šå€¤;

            if (å‡ºç›® === 10) {
                if (ã‚­ãƒ£ãƒ©[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å] > 1) ã‚­ãƒ£ãƒ©[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å]--;
                å‡ºåŠ›(`ğŸ’¥ ${ã‚­ãƒ£ãƒ©.name} ã¯å¤§å¤±æ•—ï¼${ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å} ãŒ 1 æ¸›å°‘ â†’ ${ã‚­ãƒ£ãƒ©[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å]}`, "danger");
                return false;
            }

            if (å‡ºç›® === 1) {
                if (ã‚­ãƒ£ãƒ©[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å] < 10) {
                    ã‚­ãƒ£ãƒ©[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å]++;
                    å‡ºåŠ›(`ğŸ‰ ${ã‚­ãƒ£ãƒ©.name} ã®ã€${ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å}ã€‘ãŒæˆé•·ï¼â†’ ${ã‚­ãƒ£ãƒ©[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å]}`, "growth");
                }
            }

            return æˆåŠŸ;
        }

        function startGame() {
            document.getElementById("log").textContent = "";

            const party = [
                { name: "ä¸»äººå…¬", å¿ƒ: 5, æŠ€: 5, ä½“: 5 },
                { name: "ã‚«ã‚¨ãƒ‡", å¿ƒ: 8, æŠ€: 4, ä½“: 3 },
                { name: "ã‚¢ã‚ªã‚¤", å¿ƒ: 3, æŠ€: 9, ä½“: 4 },
                { name: "ã‚¿ã‚±ãƒ«", å¿ƒ: 2, æŠ€: 3, ä½“: 9 }
            ];

            const ã‚¿ãƒ¼ãƒ³æ•° = 20;

            for (let å› = 1; å› <= ã‚¿ãƒ¼ãƒ³æ•°; å›++) {
                å‡ºåŠ›(`\nğŸŒŸ ç¬¬${å›}ã‚¤ãƒ™ãƒ³ãƒˆ`);
                const ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ = ãƒ©ãƒ³ãƒ€ãƒ (ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿);
                const é›£æ˜“åº¦å€¤ = Math.floor(Math.random() * 6) + 3;
                const ã‚¤ãƒ™ãƒ³ãƒˆ = ãƒ©ãƒ³ãƒ€ãƒ (ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ã‚­ã‚¹ãƒˆ[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹]);

                å‡ºåŠ›(`ã€${ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹}ï¼ˆæ•µã®å¼·ã•:${é›£æ˜“åº¦å€¤}ï¼‰ã€‘ã®ãƒˆãƒ©ãƒ–ãƒ«ï¼š${ã‚¤ãƒ™ãƒ³ãƒˆ}`);

                const è©¦ç·´å›æ•° = Math.random() < 0.2 ? 3 : 1;

                for (const ã‚­ãƒ£ãƒ© of party) {
                    å‡ºåŠ›(`\n${ã‚­ãƒ£ãƒ©.name} ã®åˆ¤å®š`);
                    let è©¦ç·´æˆåŠŸ = true;

                    for (let i = 1; i <= è©¦ç·´å›æ•°; i++) {
                        å‡ºåŠ›(`â–¶ è©¦ç·´ ${i}`);
                        const æˆåŠŸ = åˆ¤å®š(ã‚­ãƒ£ãƒ©, ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹, é›£æ˜“åº¦å€¤);
                        const çµæœ = æˆåŠŸ ? "æˆåŠŸ" : "å¤±æ•—";
                        å‡ºåŠ›(`çµæœï¼š${çµæœ}ï¼ˆå‡ºç›® vs åˆ¤å®šå€¤ï¼‰`, æˆåŠŸ ? "success" : "fail");

                        if (!æˆåŠŸ) è©¦ç·´æˆåŠŸ = false;
                    }

                    if (è©¦ç·´æˆåŠŸ) {
                        å‡ºåŠ›(`ğŸ¯ ${ã‚­ãƒ£ãƒ©.name} ã¯ã€${ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹}ã€‘ã®è©¦ç·´ã‚’ä¹—ã‚Šè¶ŠãˆãŸï¼`, "success");
                    } else {
                        å‡ºåŠ›(`âŒ ${ã‚­ãƒ£ãƒ©.name} ã¯ã€${ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹}ã€‘ã®è©¦ç·´ã«æ•—åŒ—ã€‚`, "fail");
                    }
                }

                å‡ºåŠ›(`\nğŸ“Š ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼š`);
                for (const ã‚­ãƒ£ãƒ© of party) {
                    å‡ºåŠ›(`${ã‚­ãƒ£ãƒ©.name} â†’ å¿ƒ:${ã‚­ãƒ£ãƒ©.å¿ƒ} æŠ€:${ã‚­ãƒ£ãƒ©.æŠ€} ä½“:${ã‚­ãƒ£ãƒ©.ä½“}`);
                }
            }

            å‡ºåŠ›("\nğŸ å†’é™ºãŒã²ã¨ã¾ãšçµ‚ã‚ã‚‹ï¼");
        }
    </script>
</body>

</html>